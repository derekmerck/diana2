DIANA Docker Swarm Stacks
=========================

Derek Merck  
<derek_merck@brown.edu>  
Rhode Island Hospital and Brown University  
Providence, RI  

[![Build Status](https://travis-ci.org/derekmerck/diana2.svg?branch=master)](https://travis-ci.org/derekmerck/diana2)
[![Coverage Status](https://codecov.io/gh/derekmerck/diana2/branch/master/graph/badge.svg)](https://codecov.io/gh/derekmerck/diana2)
[![Doc Status](https://readthedocs.org/projects/diana/badge/?version=latest)](https://diana.readthedocs.io/en/latest/?badge=latest)

Source: <https://www.github.com/derekmerck/diana2>  
Documentation: <https://diana.readthedocs.io>
Image:  <https://cloud.docker.com/repository/docker/derekmerck/diana2>

Admin Stack
----------------------

A base stack and provides Portainer and Traefik services and networks.

Other stacks can attach to the Traefik network by declaring the network:

```yaml
networks:
  admin_proxy_network:
    external: true
```

Data Stack
----------------

Provides database (postgres) and indexing (redis, splunk) services and allocates persistent storage.

Exposes:

- Postgres: `tcp://postgres:2345`
- Redis: `tcp://redis:6543`
- Splunk: `http://host/splunk`
- Splunk: `http://splunk:{8088,8089}`

```bash
$ source sample.env
$ docker-stack -f admin/admin-stack.yml
$ docker-stack -f data/data-stack.yml
```

Mock PACS Stack
-----------------

Provides an Orthanc DICOM node and fills it continuously with simulated DICOM headers generated by DIANA's MockSite daemon.

By default, the orthanc node is exposed at:

- Orthanc: `http://host/mock-pacs ` 
- Orthanc: `dcm:MOCKPACS@orthanc-mock:4242`  

### Setup

```bash
$ source sample.env
$ docker-stack -f admin/admin-stack.yml
$ docker-stack -f mock-pacs/mock-stack.yml
```